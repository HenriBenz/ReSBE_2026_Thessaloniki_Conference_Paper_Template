\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{resbe2026}[2026/01/01 RESBE2026 formatting]

% ---------- Page size + margins ----------
\RequirePackage[
  a4paper,
  top=5.2cm,
  bottom=5.2cm,
  left=4.4cm,
  right=4.4cm
]{geometry}

% ---------- Font: Times New Roman-like ----------
\RequirePackage[T1]{fontenc}
\RequirePackage[utf8]{inputenc}
\RequirePackage{newtxtext,newtxmath}
\RequirePackage{microtype}
\RequirePackage{courier}

% ---------- Justified text ----------
\RequirePackage{ragged2e}
\AtBeginDocument{\justifying}

% ---------- Paragraph indentation rules ----------
\setlength{\parindent}{10pt}
\setlength{\parskip}{0pt}

% First paragraph after figure/table/equation should NOT be indented
\RequirePackage{noindentafter}
\NoIndentAfterEnv{figure}
\NoIndentAfterEnv{table}
\NoIndentAfterEnv{equation}
\NoIndentAfterEnv{align}
\NoIndentAfterEnv{gather}

% "p1a" paragraph style: flush-left paragraph (no first-line indent)
\newenvironment{p1a}{%
  \par\begingroup
  \setlength{\parindent}{0pt}%
  \noindent\ignorespaces
}{%
  \par\endgroup
}

% ---------- Headings ----------
\RequirePackage{titlesec}

% heading indent (match Word template; tweak if needed)
\newlength{\headingindent}
\setlength{\headingindent}{10pt}

% 1st-level heading: 12pt bold
\titleformat{\section}
  {\fontsize{12}{14}\selectfont\bfseries}
  {\thesection}{0.6em}{}
\titlespacing*{\section}{\headingindent}{12pt}{6pt}

% 2nd-level heading: 10pt bold
\titleformat{\subsection}
  {\fontsize{10}{12}\selectfont\bfseries}
  {\thesubsection}{0.6em}{}
\titlespacing*{\subsection}{\headingindent}{10pt}{4pt}

% number only two levels
\setcounter{secnumdepth}{2}

% 3rd-level run-in: bold + period
\titleformat{\subsubsection}[runin]
  {\fontsize{10}{12}\selectfont\bfseries}
  {}{0pt}{}[.]
\titlespacing*{\subsubsection}{\headingindent}{8pt}{0.6em}

% 4th-level run-in: italic + period
\titleformat{\paragraph}[runin]
  {\fontsize{10}{12}\selectfont\itshape}
  {}{0pt}{}[.]
\titlespacing*{\paragraph}{\headingindent}{6pt}{0.6em}

% ---------- Figures / tables + captions (9pt) ----------
\RequirePackage{graphicx}
\RequirePackage{booktabs}
\RequirePackage[labelsep=colon]{caption}

\DeclareCaptionFont{capnine}{\fontsize{9}{11}\selectfont}
\captionsetup{
  font=capnine,
  labelfont=normalfont,
  textfont=normalfont,
  justification=justified,
  singlelinecheck=true
}
\captionsetup[table]{position=top}
\captionsetup[figure]{position=bottom}

% --- TABLES: "Table 1:" in bold (including colon) ---
\DeclareCaptionLabelSeparator{boldcolon}{\textbf{:}\space}
\captionsetup[table]{name=Table, labelfont=bf, labelsep=boldcolon}

% --- FIGURES: "Fig. 1." in bold ---
\DeclareCaptionLabelSeparator{bolddot}{\textbf{.}\space}
\captionsetup[figure]{name=Fig., labelfont=bf, labelsep=bolddot}



% ---------- Equations ----------
\RequirePackage{amsmath}
\renewcommand{\theequation}{\arabic{equation}}

% ---------- Indented Abstract + Keywords ----------
\RequirePackage{changepage}
\newlength{\abskwindent}
\setlength{\abskwindent}{1.0cm}

\newenvironment{resbeabstract}{%
  \begin{adjustwidth}{\abskwindent}{\abskwindent}%
  \noindent\textbf{Abstract.}\hspace{0.6em}\ignorespaces
}{%
  \par\end{adjustwidth}\vspace{6pt}
}

\newcommand{\resbekeywords}[1]{%
  \begin{adjustwidth}{\abskwindent}{\abskwindent}%
  \noindent\textbf{Keywords:} #1\par
  \end{adjustwidth}\vspace{12pt}
}

% ---------- References (biblatex/biber): label "1." + Author (Year) ----------
\RequirePackage[
  backend=biber,
  style=numeric,
  sorting=none,
  giveninits=true,
  maxbibnames=99
]{biblatex}

% bibliography labels: "1." instead of "[1]" (works across biblatex versions)
\DeclareFieldFormat{labelnumberwidth}{#1.}
\setlength{\biblabelsep}{0.6em}


% helper: print (Year) right after author
\newcommand{\printyearparens}{%
  \setunit{\space}%
  \printtext{%
    \mkbibparens{%
      \iffieldundef{year}{\printdate}{\printfield{year}}%
    }%
  }%
}

% Drivers (match template examples)
\DeclareBibliographyDriver{article}{%
  \printnames{author}\printyearparens\newunit\newblock
  \printfield{title}\newunit\newblock
  \printfield{journaltitle}%
  \setunit{\addspace}%
  \printfield{volume}%
  \iffieldundef{number}{}{%
    \printtext{\mkbibparens{\printfield{number}}}%
  }%
  \newunit\newblock
  \printfield{pages}%
  \finentry
}

\DeclareBibliographyDriver{inproceedings}{%
  \printnames{author}\printyearparens\newunit\newblock
  \printfield{title}\newunit\newblock
  In\addcolon\space
  \printfield{booktitle}\newunit\newblock
  \printfield{pages}%
  \finentry
}

\DeclareBibliographyDriver{book}{%
  \printnames{author}\printyearparens\newunit\newblock
  \printfield{title}\newunit\newblock
  \printlist{publisher}%
  \setunit{\addcomma\space}%
  \printlist{location}%
  \finentry
}

\DeclareBibliographyDriver{misc}{%
  \printnames{author}\printyearparens\newunit\newblock
  \printfield{title}\newunit\newblock
  \printfield{howpublished}%
  \newunit\newblock
  \printfield{url}%
  \newunit\newblock
  \printfield{note}%
  \finentry
}

% ---------- Hyperlinks ----------
\RequirePackage[hidelinks]{hyperref}

% ---------- Page numbers ----------
\RequirePackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
\fancyhead[LE,RO]{\thepage}
\setlength{\headheight}{14pt}

% ---------- Title block ----------
\makeatletter
\renewcommand{\maketitle}{%
  \begingroup
  \centering
  {\fontsize{14}{16}\selectfont\bfseries
    \begingroup
    \hyphenpenalty=10000\exhyphenpenalty=10000
    \@title\par
    \endgroup
  }%
  \vspace{25pt}%
  {\fontsize{10}{12}\selectfont \@author\par}
  \vspace{8pt}
  \endgroup
}
\makeatother

% ---------- Simple affiliation helper ----------
\newcommand{\affilline}[1]{\par\noindent #1}

\endinput
